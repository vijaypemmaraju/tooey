function we(e=null){return{el:e}}var ie=0,q=new Map;function Ee(e){let n=ie++;return q.set(n,[e]),{_id:n,_default:e}}function ke(e){let n=q.get(e._id);return!n||n.length===0?e._default:n[n.length-1]}function se(e,n){let o=q.get(e._id);o&&o.push(n)}function ae(e){let n=q.get(e._id);n&&n.length>1&&n.pop()}function V(e){return typeof e=="object"&&e!==null&&"boundary"in e&&e.boundary===!0}function Y(e){let n=document.createElement("div");return n.style.cssText="padding:12px;background:#fee;border:1px solid #fcc;border-radius:4px;color:#c00;font-family:monospace;font-size:12px",n.textContent=`[tooey error] ${e.message}`,n}var v=null,j=0,W=new Set;function Q(e){let n=e,o=new Set,r=(()=>(v&&o.add(v),n));return r.set=l=>{let f=typeof l=="function"?l(n):l;f!==n&&(n=f,j>0?o.forEach(t=>W.add(t)):o.forEach(t=>t()))},r.sub=l=>(o.add(l),()=>o.delete(l)),r}function Z(e){j++;try{e()}finally{if(j--,j===0){let n=W;W=new Set,n.forEach(o=>o())}}}function $(e,n){let o=!0,r=()=>{if(o){v=r;try{e()}finally{v=null}}};r();let l=()=>{o=!1,v=null};return n&&n.cleanups.push(l),l}function ve(e){let n,o=!0,r=new Set,l=()=>{o=!0,j>0?r.forEach(t=>W.add(t)):r.forEach(t=>t())},f=(()=>{if(v&&r.add(v),o){let t=v;v=l;try{n=e()}finally{v=t}o=!1}return n});return f.sub=t=>(r.add(t),()=>r.delete(t)),f}function Re(e,n){return{s:{data:null,loading:!0,error:null},async init(o){try{let l=await(typeof e=="function"?e():e);o.set("data",l),o.set("loading",!1)}catch(r){let l=r instanceof Error?r.message:String(r);o.set("error",l),o.set("loading",!1),n?.onError&&r instanceof Error&&n.onError(r)}}}}function Ne(e,n){let o=n,r=null,l=t=>{let s=e(o,t);s!==o&&(o=s,r&&Z(()=>{Object.entries(s).forEach(([c,a])=>{r.set(c,a)})}))};return{s:new Proxy(n,{get(t,s){return t[s]}}),dp:l,_bind(t){r=t}}}function Ae(e,n){let o=null,r,f=n||((t,s)=>{if(t===s)return!0;if(!t||!s)return!1;let c=Object.keys(t),a=Object.keys(s);return c.length!==a.length?!1:c.every(u=>t[u]===s[u])});return(t,s)=>(o&&f(r,t)||(r=t,o=e(t,s)),o)}function ee(e,n,o){try{switch(n){case"+":e.set(r=>r+(typeof o=="number"?o:1));break;case"-":e.set(r=>r-(typeof o=="number"?o:1));break;case"!":e.set(o);break;case"~":e.set(r=>!r);break;case"<":e.set(r=>[...r,o]);break;case">":e.set(r=>[o,...r]);break;case"X":e.set(r=>{let l=r;return typeof o=="number"?l.filter((f,t)=>t!==o):typeof o=="function"?l.filter((f,t)=>!o(f,t)):l.filter(f=>f!==o)});break;case".":Array.isArray(o)&&o.length===2&&e.set(r=>({...r,[o[0]]:o[1]}));break}}catch(r){console.warn("[tooey] state operation error:",n,r)}}function H(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)&&"$"in e}function A(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)&&("if"in e||"?"in e)}function C(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)&&("map"in e||"m"in e)}function _(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)&&"pv"in e}function B(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)&&"pt"in e}function D(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)&&"mm"in e&&"c"in e}function x(e,n){if(H(e)){let o=n[e.$];if(!o){console.warn(`[tooey] unknown state key: "${e.$}"`);return}return o()}return e}function ce(e){if(e!==void 0)return typeof e=="number"?`${e}px`:e}function ue(e,n){if(!n)return;let o=["colors","spacing","radius","fonts"];for(let r of o){let l=n[r];if(l&&e in l)return l[e]}for(let[r,l]of Object.entries(n))if(l&&!o.includes(r)&&e in l)return l[e]}var F={c:"center",sb:"space-between",sa:"space-around",se:"space-evenly",fe:"flex-end",fs:"flex-start",st:"stretch",bl:"baseline"};function z(e){if(e!==void 0)return F[e]||e}function ne(e){if(typeof e!="string"||e.length<2)return null;let n=e[e.length-1];if(n==="+"||n==="-"||n==="~")return[e.slice(0,-1),n];let o=e.indexOf("!");if(o>0){let r=e.slice(0,o),l=e.slice(o+1),f=l;return l==="true"?f=!0:l==="false"?f=!1:!isNaN(Number(l))&&l!==""&&(f=Number(l)),[r,"!",f]}return null}var le=["http:","https:","mailto:","tel:","ftp:"];function fe(e){if(!e||typeof e!="string")return!1;if(e.startsWith("/")||e.startsWith("#")||e.startsWith("."))return!0;try{let n=new URL(e,window.location.href);return le.includes(n.protocol)}catch{let n=e.toLowerCase().trim();return!["javascript:","data:","vbscript:"].some(r=>n.startsWith(r))}}function J(e,n){return e?fe(e)?e:(console.warn(`[tooey] blocked unsafe URL in ${n}: "${e.slice(0,50)}..."`),null):null}function N(e,n,o,r,l){if(typeof e=="function")return e;let f;if(typeof e=="string"){let a=ne(e);a?f=a:l==="+"?f=[e,"+"]:l==="-"?f=[e,"-"]:f=[e,"~"]}else f=e;let[t,s,c]=f;return()=>{let a=n[t];if(!a){console.warn(`[tooey] click handler: unknown state key "${t}"`);return}let u=c;if(r&&typeof u=="string"){if(u==="$index")u=r.index;else if(u==="$item")u=r.item;else if(u.startsWith("$item.")){let p=u.substring(6);u=r.item?.[p]}}if(s==="!"&&c===void 0&&o){let p=o.target;u=p.type==="checkbox"?p.checked:p.value}ee(a,s,u)}}function U(e,n){if(e!==void 0){if(typeof e=="string"&&e.startsWith("$")){let o=e.slice(1),r=ue(o,n);if(r!==void 0)return r;console.warn(`[tooey] unknown theme token: "${e}"`);return}return e}}function de(e,n,o){let r=e.style,l=t=>{let s=U(t,o);return ce(s)},f=t=>{if(t===void 0)return;let s=U(t,o);return s!==void 0?String(s):void 0};if(n.g!==void 0){let t=l(n.g);t&&(r.gap=t)}if(n.p!==void 0){let t=l(n.p);t&&(r.padding=t)}if(n.m!==void 0){let t=l(n.m);t&&(r.margin=t)}if(n.w!==void 0){let t=l(n.w);t&&(r.width=t)}if(n.h!==void 0){let t=l(n.h);t&&(r.height=t)}if(n.mw!==void 0){let t=l(n.mw);t&&(r.maxWidth=t)}if(n.mh!==void 0){let t=l(n.mh);t&&(r.maxHeight=t)}if(n.bg!==void 0){let t=f(n.bg);t&&(r.background=t)}if(n.fg!==void 0){let t=f(n.fg);t&&(r.color=t)}if(n.o!==void 0&&(r.opacity=String(n.o)),n.r!==void 0){let t=l(n.r);t&&(r.borderRadius=t)}if(n.bw!==void 0){let t=l(n.bw);t&&(r.borderWidth=t)}if(n.bc!==void 0){let t=f(n.bc);t&&(r.borderColor=t)}if(n.bs!==void 0&&(r.borderStyle=n.bs),n.pos!==void 0){let t={rel:"relative",abs:"absolute",fix:"fixed",sticky:"sticky"};r.position=t[n.pos]||n.pos}if(n.z!==void 0&&(r.zIndex=String(n.z)),n.t!==void 0){let t=l(n.t);t&&(r.top=t)}if(n.l!==void 0){let t=l(n.l);t&&(r.left=t)}if(typeof n.b=="number"||typeof n.b=="string"&&!Array.isArray(n.b)){let t=l(n.b);t&&(r.bottom=t)}if(n.rt!==void 0){let t=l(n.rt);t&&(r.right=t)}if(n.fs!==void 0){let t=l(n.fs);t&&(r.fontSize=t)}if(n.fw!==void 0&&(r.fontWeight=String(n.fw)),n.ff!==void 0){let t=f(n.ff);t&&(r.fontFamily=t)}if(n.ta!==void 0&&(r.textAlign=n.ta),n.td!==void 0&&(r.textDecoration=n.td),n.lh!==void 0&&(r.lineHeight=typeof n.lh=="number"?String(n.lh):n.lh),n.ls!==void 0){let t=l(n.ls);t&&(r.letterSpacing=t)}if(n.ai!==void 0&&(r.alignItems=z(n.ai)),n.jc!==void 0&&(r.justifyContent=z(n.jc)),n.flw!==void 0&&(r.flexWrap=z(n.flw)),n.cur!==void 0&&(r.cursor=n.cur),n.ov!==void 0&&(r.overflow=n.ov),n.pe!==void 0&&(r.pointerEvents=n.pe),n.us!==void 0&&(r.userSelect=n.us),n.sh!==void 0){let t=f(n.sh);t&&(r.boxShadow=t)}n.tr!==void 0&&(r.transform=n.tr),n.s&&Object.entries(n.s).forEach(([t,s])=>{let c=U(s,o);c!==void 0&&(r[t]=String(c))})}function T(e,n,o){let{state:r}=n;if(V(e)){let i=document.createElement("div");i.style.display="contents";try{let d={cleanups:[],state:r,onError:e.onError||n.onError},g=T(e.child,d,o);g&&(i.appendChild(g),n.cleanups.push(...d.cleanups))}catch(d){let g={message:d instanceof Error?d.message:String(d),stack:d instanceof Error?d.stack:void 0};if(e.onError&&e.onError(g),e.fallback)try{let y=T(e.fallback,n,o);y&&i.appendChild(y)}catch{i.appendChild(Y(g))}else i.appendChild(Y(g))}return i}if(A(e)){let i=document.createElement("div");i.style.display="contents";let d=null,g=null,y=e.if??e["?"],m=e.then??e.t,h=e.else??e.e,b=e.eq??e.is;return $(()=>{g&&(g.cleanups.forEach(k=>k()),g.cleanups=[]),d&&(i.innerHTML="",d=null);let E=typeof y=="string"?r[y]?.():x(y,r),R;b!==void 0?R=E===b:R=!!E;let S=R?m:h;S&&(g={cleanups:[],state:r},Array.isArray(S)&&S.length>0&&Array.isArray(S[0])?S.forEach(k=>{let M=T(k,g,o);M&&i.appendChild(M)}):(d=T(S,g,o),d&&i.appendChild(d)))},n),i}if(C(e)){let i=document.createElement("div");i.style.display="contents";let d=null,g=e.map??e.m,y=e.as??e.a;return $(()=>{d&&(d.cleanups.forEach(b=>b()),d.cleanups=[]),i.innerHTML="";let h=typeof g=="string"?r[g]?.():x(g,r);!Array.isArray(h)||!y||(d={cleanups:[],state:r},h.forEach((b,w)=>{let E=T(y,d,{item:b,index:w});E&&i.appendChild(E)}))},n),i}if(_(e)){let i=document.createElement("div");i.style.display="contents",se(e.pv,e.v);let d=y=>{let m=y[0];return typeof m=="function"?!1:Array.isArray(m)||A(m)||C(m)||_(m)||B(m)||D(m)||V(m)};return(Array.isArray(e.c)&&e.c.length>0&&d(e.c)?e.c:[e.c]).forEach(y=>{let m=T(y,n,o);m&&i.appendChild(m)}),n.cleanups.push(()=>ae(e.pv)),i}if(B(e)){let i=typeof e.pt=="string"?document.querySelector(e.pt):e.pt;if(!i)return console.warn(`[tooey] portal target not found: ${e.pt}`),null;let d=document.createElement("div");d.style.display="contents",d.setAttribute("data-tooey-portal","true");let g=h=>{let b=h[0];return typeof b=="function"?!1:Array.isArray(b)||A(b)||C(b)||_(b)||B(b)||D(b)||V(b)};(Array.isArray(e.c)&&e.c.length>0&&g(e.c)?e.c:[e.c]).forEach(h=>{let b=T(h,n,o);b&&d.appendChild(b)}),i.appendChild(d),n.cleanups.push(()=>{d.parentNode&&d.parentNode.removeChild(d)});let m=document.createElement("div");return m.style.display="none",m.setAttribute("data-tooey-portal-anchor","true"),m}if(D(e)){let i=document.createElement("div");i.style.display="contents";let d=null,g=null,y=[];return $(()=>{let h=e.mm.map(w=>r[w]?.());!(y.length===0||h.some((w,E)=>w!==y[E]))&&d||(y=h,g&&(g.cleanups.forEach(w=>w()),g.cleanups=[]),d&&(i.innerHTML="",d=null),g={cleanups:[],state:r,theme:n.theme,plugins:n.plugins},d=T(e.c,g,o),d&&(i.appendChild(d),n.cleanups.push(...g.cleanups)))},n),i}if(!Array.isArray(e)||e.length===0)return console.warn("[tooey] invalid node spec:",e),null;let l=e;if(n.plugins)for(let i of n.plugins)i.beforeRender&&(l=i.beforeRender(l,n));if(!Array.isArray(l))return T(l,n,o);let[f,t,s={}]=l;if(typeof f=="function"){let i=Array.isArray(t)&&t.length>0&&(Array.isArray(t[0])||A(t[0])||C(t[0])||typeof t[0]=="function")?t:void 0,d=f(s,i);return T(d,n,o)}let c=f;if(s.show!==void 0){let i=s.show,d=document.createElement("div");d.style.display="contents";let g=null,y=null;return $(()=>{if(y&&(y.cleanups.forEach(E=>E()),y.cleanups=[]),g&&(d.innerHTML="",g=null),!r[i]?.())return;let{show:b,...w}=s;y={cleanups:[],state:r,theme:n.theme,plugins:n.plugins},g=T([c,t,w],y,o),g&&(d.appendChild(g),n.cleanups.push(...y.cleanups))},n),d}let a;switch(c){case"vs":a=document.createElement("div"),a.style.display="flex",a.style.flexDirection="column";break;case"hs":a=document.createElement("div"),a.style.display="flex",a.style.flexDirection="row";break;case"gr":a=document.createElement("div"),a.style.display="grid",s.cols&&(a.style.gridTemplateColumns=typeof s.cols=="number"?`repeat(${s.cols}, 1fr)`:s.cols),s.rows&&(a.style.gridTemplateRows=typeof s.rows=="number"?`repeat(${s.rows}, 1fr)`:s.rows);break;case"dv":a=document.createElement("div");break;case"tx":a=document.createElement("span");break;case"bt":a=document.createElement("button");break;case"in":a=document.createElement("input"),a.type=s.type||"text",s.ph&&(a.placeholder=s.ph),s.ro&&(a.readOnly=!0);break;case"ta":a=document.createElement("textarea"),s.ph&&(a.placeholder=s.ph),s.rw&&(a.rows=s.rw),s.ro&&(a.readOnly=!0);break;case"sl":a=document.createElement("select"),s.opts&&s.opts.forEach(i=>{let d=document.createElement("option");d.value=i.v,d.textContent=i.l,a.appendChild(d)});break;case"cb":a=document.createElement("input"),a.type="checkbox";break;case"rd":a=document.createElement("input"),a.type="radio";break;case"tb":a=document.createElement("table");break;case"th":a=document.createElement("thead");break;case"bd":a=document.createElement("tbody");break;case"tr":a=document.createElement("tr");break;case"td":a=document.createElement("td"),s.sp&&(a.colSpan=s.sp),s.rsp&&(a.rowSpan=s.rsp);break;case"tc":a=document.createElement("th"),s.sp&&(a.colSpan=s.sp),s.rsp&&(a.rowSpan=s.rsp);break;case"ul":a=document.createElement("ul");break;case"ol":a=document.createElement("ol");break;case"li":a=document.createElement("li");break;case"im":if(a=document.createElement("img"),s.src){let i=J(s.src,"src");i&&(a.src=i)}s.alt&&(a.alt=s.alt);break;case"ln":if(a=document.createElement("a"),s.href){let i=J(s.href,"href");i&&(a.href=i)}break;case"sv":a=document.createElementNS("http://www.w3.org/2000/svg","svg");break;case"fr":a=document.createElement("div"),a.style.display="contents",a.setAttribute("data-tooey-fragment","true");break;default:console.warn(`[tooey] unknown component type: ${c}`),a=document.createElement("div")}if(s.rf&&(typeof s.rf=="function"?s.rf(a):s.rf.el=a),s.cls&&(a.className=s.cls),s.id&&(a.id=s.id),s.dis&&(a.disabled=!0),de(a,s,n.theme),t!==void 0){if(Array.isArray(t)&&t.length>0&&(Array.isArray(t[0])||A(t[0])||C(t[0])||V(t[0])))t.forEach(i=>{let d=T(i,n,o);d&&a.appendChild(d)});else if(A(t)||C(t)||V(t)){let i=T(t,n,o);i&&a.appendChild(i)}else if(H(t))$(()=>{let i=x(t,r);c==="in"||c==="ta"?a.value=String(i??""):c==="cb"||c==="rd"?a.checked=!!i:a.textContent=String(i??"")},n);else if(typeof t=="string"||typeof t=="number"){let i=String(t);o&&(typeof o.item=="object"&&o.item!==null&&(i=i.replace(/\$item\.(\w+)/g,(d,g)=>String(o.item[g]??""))),i=i.replace(/\$item/g,String(o.item)),i=i.replace(/\$index/g,String(o.index))),c==="in"||c==="ta"?a.value=i:c!=="sl"&&(a.textContent=i)}}s.v!==void 0&&H(s.v)&&$(()=>{let i=x(s.v,r);c==="in"||c==="sl"||c==="ta"?a.value=String(i??""):(c==="cb"||c==="rd")&&(a.checked=!!i)},n),s.ch!==void 0&&(H(s.ch)?$(()=>{let i=x(s.ch,r);a.checked=!!i},n):a.checked=!!s.ch);let u=(i,d)=>{a.addEventListener(i,d),n.cleanups.push(()=>a.removeEventListener(i,d))},p=c==="bt"&&(typeof t=="string"||typeof t=="number")?String(t):void 0;if(s.c&&u("click",i=>N(s.c,r,i,o,p)()),s.x){let i=s.x;u("input",d=>{if(typeof i=="function")i();else{let g,y;if(typeof i=="string"){let h=ne(i);h?[g,y]=h:(g=i,y="!")}else[g,y]=i;let m=r[g];if(m){let h=d.target,b=c==="cb"||c==="rd"?h.checked:h.value;ee(m,y,b)}}})}if(s.f&&u("focus",i=>N(s.f,r,i,o)()),s.bl&&u("blur",i=>N(s.bl,r,i,o)()),s.k&&u("keydown",i=>N(s.k,r,i,o)()),s.ku&&u("keyup",i=>N(s.ku,r,i,o)()),s.kp&&u("keypress",i=>N(s.kp,r,i,o)()),s.e&&u("mouseenter",i=>N(s.e,r,i,o)()),s.lv&&u("mouseleave",i=>N(s.lv,r,i,o)()),s.sub&&u("submit",i=>{i.preventDefault(),N(s.sub,r,i,o)()}),n.plugins)for(let i of n.plugins)i.afterRender&&i.afterRender(a,l);return a}function te(e,n,o){if(!e)throw new Error("[tooey] render requires a valid container element");if(!n||!n.r)throw new Error("[tooey] render requires a spec with a root node (r)");let r=o?.theme,l=o?.plugins||[],f=(u,p)=>{let i=Q(p),d=i.set.bind(i);return i.set=g=>{let y=i();d(g);let m=i();y!==m&&l.forEach(h=>h.onStateChange?.(u,y,m))},i},t={};n.s&&Object.entries(n.s).forEach(([u,p])=>{t[u]=f(u,p)});let s={cleanups:[],state:t,theme:r,plugins:l};e.innerHTML="";let c=T(n.r,s);c&&e.appendChild(c);let a={state:t,el:c,destroy(){l.forEach(u=>u.onDestroy?.(a)),s.cleanups.forEach(u=>u()),s.cleanups=[],e.innerHTML=""},update(u){if(u.s&&Z(()=>{Object.entries(u.s).forEach(([p,i])=>{t[p]?t[p].set(i):t[p]=f(p,i)})}),u.r){s.cleanups.forEach(i=>i()),s.cleanups=[],e.innerHTML="";let p=T(u.r,s);p&&e.appendChild(p),a.el=p}},get(u){return t[u]?.()},set(u,p){t[u]&&t[u].set(p)}};return l.forEach(u=>{u.extend&&Object.entries(u.extend).forEach(([p,i])=>{a[p]=i.bind(a)})}),l.forEach(u=>u.onInit?.(a)),a}function Ce(e){let n=e&&("theme"in e||"plugins"in e),o=n?e.theme:e,r=n?e.plugins:void 0;return{render:(l,f)=>te(l,f,{theme:o,plugins:r}),theme:o,plugins:r}}function He(e){return{$:e}}var Me="vs",Pe="hs",G="dv",Le="gr",ge="tx",$e="bt",Ie="in",Ve="ta",xe="sl",je="cb",Oe="rd",_e="tb",Be="th",De="bd",We="tr",qe="td",ze="tc",Ue="ul",Fe="ol",Ke="li",Xe="im",pe="ln",Ye="sv",Je="fr";function me(e,n={},o){let r={};Object.entries(n).forEach(([c,a])=>{let u=(()=>a);u.set=()=>{},u.sub=()=>()=>{},r[c]=u});function l(c){if(H(c)){let a=r[c.$]?.();return a!=null?String(a):""}return String(c??"")}function f(c){if(c!==void 0){if(typeof c=="string"&&c.startsWith("$")&&o){let a=c.slice(1),u=["colors","spacing","radius","fonts"];for(let p of u){let i=o[p];if(i&&a in i){let d=i[a];return typeof d=="number"?`${d}px`:String(d)}}}return typeof c=="number"?`${c}px`:c}}function t(c){let a=[];if(c.g!==void 0){let u=f(c.g);u&&a.push(`gap:${u}`)}if(c.p!==void 0){let u=f(c.p);u&&a.push(`padding:${u}`)}if(c.m!==void 0){let u=f(c.m);u&&a.push(`margin:${u}`)}if(c.w!==void 0){let u=f(c.w);u&&a.push(`width:${u}`)}if(c.h!==void 0){let u=f(c.h);u&&a.push(`height:${u}`)}if(c.bg!==void 0){let u=f(c.bg);u&&a.push(`background:${u}`)}if(c.fg!==void 0){let u=f(c.fg);u&&a.push(`color:${u}`)}if(c.r!==void 0){let u=f(c.r);u&&a.push(`border-radius:${u}`)}if(c.fs!==void 0){let u=f(c.fs);u&&a.push(`font-size:${u}`)}return c.fw!==void 0&&a.push(`font-weight:${c.fw}`),c.ai!==void 0&&a.push(`align-items:${F[c.ai]||c.ai}`),c.jc!==void 0&&a.push(`justify-content:${F[c.jc]||c.jc}`),a.join(";")}function s(c){if(A(c)){let S=c.if??c["?"],k=c.then??c.t,M=c.else??c.e,P=c.eq??c.is,O=typeof S=="string"?r[S]?.():H(S)?r[S.$]?.():S,L=(P!==void 0?O===P:!!O)?k:M;return L?Array.isArray(L)&&L.length>0&&Array.isArray(L[0])?L.map(s).join(""):s(L):""}if(C(c)){let S=c.map??c.m,k=c.as??c.a;if(!k)return"";let M=typeof S=="string"?r[S]?.():H(S)?r[S.$]?.():S;return Array.isArray(M)?M.map((P,O)=>{let X=typeof P=="object"?JSON.stringify(P):String(P);return s(k).replace(/\$item\.(\w+)/g,(L,oe)=>String(P?.[oe]??"")).replace(/\$item/g,X).replace(/\$index/g,String(O))}).join(""):""}if(_(c))return(Array.isArray(c.c)&&c.c.length>0&&Array.isArray(c.c[0])?c.c:[c.c]).map(s).join("");if(B(c))return"<!-- portal -->";if(D(c))return s(c.c);if(V(c))try{return s(c.child)}catch{return c.fallback?s(c.fallback):"<div>[error]</div>"}if(!Array.isArray(c)||c.length===0)return"";let[a,u,p={}]=c;if(typeof a=="function"){let S=Array.isArray(u)&&u.length>0&&Array.isArray(u[0])?u:void 0,k=a(p,S);return s(k)}let i=a,g={vs:"div",hs:"div",dv:"div",gr:"div",fr:"div",tx:"span",bt:"button",in:"input",ta:"textarea",sl:"select",cb:"input",rd:"input",tb:"table",th:"thead",bd:"tbody",tr:"tr",td:"td",tc:"th",ul:"ul",ol:"ol",li:"li",im:"img",ln:"a",sv:"svg"}[i]||"div",y=["input","img"].includes(g),m=[],h="";i==="vs"&&(h="display:flex;flex-direction:column;"),i==="hs"&&(h="display:flex;flex-direction:row;"),i==="gr"&&(h="display:grid;"),i==="fr"&&(h="display:contents;");let b=t(p),w=h+b;w&&m.push(`style="${w}"`),p.cls&&m.push(`class="${p.cls}"`),p.id&&m.push(`id="${p.id}"`),p.dis&&m.push("disabled"),p.href&&m.push(`href="${p.href}"`),p.src&&m.push(`src="${p.src}"`),p.alt&&m.push(`alt="${p.alt}"`),p.ph&&m.push(`placeholder="${p.ph}"`),p.type&&m.push(`type="${p.type}"`),i==="cb"&&m.push('type="checkbox"'),i==="rd"&&m.push('type="radio"'),m.push('data-tooey-ssr="true"');let E=m.length>0?" "+m.join(" "):"";if(y)return`<${g}${E}/>`;let R="";return u!==void 0&&(Array.isArray(u)&&u.length>0&&(Array.isArray(u[0])||A(u[0])||C(u[0]))?R=u.map(s).join(""):A(u)||C(u)?R=s(u):(typeof u=="string"||typeof u=="number"||H(u))&&(R=l(u))),i==="sl"&&p.opts&&(R=p.opts.map(S=>`<option value="${S.v}">${S.l}</option>`).join("")),`<${g}${E}>${R}</${g}>`}return s(e)}function Ge(e,n){return me(e.r,e.s||{},n?.theme)}function Qe(e,n,o){return te(e,n,o)}var I=null,K="";function re(e=""){if(I)return I;K=e;let n=()=>{let o=window.location.pathname.replace(e,"")||"/",r={};return new URLSearchParams(window.location.search).forEach((l,f)=>{r[f]=l}),{path:o,params:{},query:r}};return I=Q(n()),window.addEventListener("popstate",()=>{I?.set(n())}),I}function ye(e,n){let o=K+e;if(n?.replace?window.history.replaceState(null,"",o):window.history.pushState(null,"",o),I){let r={};new URLSearchParams(window.location.search).forEach((l,f)=>{r[f]=l}),I.set({path:e,params:{},query:r})}}function he(e,n){let o=e.split("/").filter(Boolean),r=n.split("/").filter(Boolean);if(o.length!==r.length&&!o.some(f=>f==="*"))return{match:!1,params:{}};let l={};for(let f=0;f<o.length;f++){let t=o[f],s=r[f];if(t==="*")return{match:!0,params:l};if(t.startsWith(":"))l[t.slice(1)]=s||"";else if(t!==s)return{match:!1,params:{}}}return{match:!0,params:l}}var be=e=>{let n=e?.routes||[],o=e?.base||"";return re(o),{"?":{$:"_routerMatch"},t:[G,"Route matched"],e:[G,"No route matched"]}};function Se(e,n=""){let o=re(n);return[()=>{let{path:l}=o();for(let f of e){let{match:t,params:s}=he(f.p,l);if(t)return Object.keys(s).length>0&&o.set(c=>({...c,params:s})),typeof f.c=="function"?f.c({params:s}):f.c}return[ge,""]}]}var Te=(e,n)=>{let o=e?.to||"/";return[pe,n||o,{href:K+o,c:()=>{ye(o)},cls:e?.cls}]},Ze=be,en=Te;function nn(e){return Se(e)}function tn(e){let n=e?.name||"tooey",o=e?.log??!0,r=[];return{name:"devtools",onInit(l){o&&console.log(`[${n}] initialized`,{state:Object.fromEntries(Object.entries(l.state).map(([f,t])=>[f,t()]))}),typeof window<"u"&&(window.__TOOEY_DEVTOOLS__={instance:l,getState:()=>Object.fromEntries(Object.entries(l.state).map(([f,t])=>[f,t()])),setState:(f,t)=>l.set(f,t),getHistory:()=>r,clearHistory:()=>{r=[]}})},onDestroy(l){o&&console.log(`[${n}] destroyed`),typeof window<"u"&&delete window.__TOOEY_DEVTOOLS__},onStateChange(l,f,t){r.push({timestamp:Date.now(),key:l,oldVal:f,newVal:t}),r.length>100&&(r=r.slice(-100)),o&&console.log(`[${n}] state change:`,l,f,"\u2192",t)}}}export{He as $,Ie as In,qe as Td,We as Tr,Re as async$,Z as batch,De as bd,$e as bt,je as cb,ve as computed,Se as createRouterView,Ce as createTooey,Ee as cx,tn as devtools,G as dv,$ as effect,Je as fr,Le as gr,Pe as hs,Qe as hy,Xe as im,Ke as li,en as lk,pe as ln,Ae as mm,ye as nav,Fe as ol,nn as ot,Oe as rd,Ne as rd$,we as ref,te as render,Ze as rt,Ge as rts,Q as signal,xe as sl,Ye as sv,Ve as ta,_e as tb,ze as tc,Be as th,ge as tx,Ue as ul,ke as ux,Me as vs};
//# sourceMappingURL=tooey.esm.js.map
